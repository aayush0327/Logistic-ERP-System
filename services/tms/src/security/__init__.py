"""
Security module for TMS Service
"""
from .auth import (
    TokenData,
    verify_token,
    extract_token_from_header,
    log_authentication_event,
)
from .exceptions import (
    SecurityException,
    AuthenticationError,
    AuthorizationError,
    TokenExpiredError,
    TokenInvalidError,
    PermissionDeniedError,
    TenantAccessError,
    RateLimitExceededError,
    AccountLockedException,
    security_exception_handler,
    http_exception_handler,
    validation_exception_handler,
    general_exception_handler,
    log_security_event,
)
from .dependencies import (
    get_current_token_data,
    require_permissions,
    require_any_permission,
    require_tenant_access,
    get_current_tenant_id,
    get_current_user_id,
    is_active_user,
    # TMS-specific permissions
    TRIP_READ,
    TRIP_READ_ALL,
    TRIP_CREATE,
    TRIP_UPDATE,
    TRIP_DELETE,
    TRIP_ASSIGN,
    TRIP_TRACK,
    ORDER_SPLIT,
    ORDER_REASSIGN,
    RESOURCES_READ,
    RESOURCES_READ_ALL,
    DRIVERS_ASSIGN,
    DRIVERS_UPDATE,
    VEHICLES_TRACK,
    VEHICLES_UPDATE,
    ROUTES_CREATE,
    ROUTES_OPTIMIZE,
    SCHEDULES_READ,
    SCHEDULES_UPDATE,
)

__all__ = [
    "TokenData",
    "verify_token",
    "extract_token_from_header",
    "log_authentication_event",
    "SecurityException",
    "AuthenticationError",
    "AuthorizationError",
    "TokenExpiredError",
    "TokenInvalidError",
    "PermissionDeniedError",
    "TenantAccessError",
    "RateLimitExceededError",
    "AccountLockedException",
    "security_exception_handler",
    "http_exception_handler",
    "validation_exception_handler",
    "general_exception_handler",
    "log_security_event",
    "get_current_token_data",
    "require_permissions",
    "require_any_permission",
    "require_tenant_access",
    "get_current_tenant_id",
    "get_current_user_id",
    "is_active_user",
    "TRIP_READ",
    "TRIP_READ_ALL",
    "TRIP_CREATE",
    "TRIP_UPDATE",
    "TRIP_DELETE",
    "TRIP_ASSIGN",
    "TRIP_TRACK",
    "ORDER_SPLIT",
    "ORDER_REASSIGN",
    "RESOURCES_READ",
    "RESOURCES_READ_ALL",
    "DRIVERS_ASSIGN",
    "DRIVERS_UPDATE",
    "VEHICLES_TRACK",
    "VEHICLES_UPDATE",
    "ROUTES_CREATE",
    "ROUTES_OPTIMIZE",
    "SCHEDULES_READ",
    "SCHEDULES_UPDATE",
]